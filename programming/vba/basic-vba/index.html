<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Chiu Yu Ko">

  
  
  
    
  
  <meta name="description" content="Learning Objectives:
 What is VBA? Why VBA? Hello World What is function? What is subroutine? How to define variable? VBA Objects Record Macro  What is VBA? Why VBA? VBA stands for Visual Basic Application.">

  
  <link rel="alternate" hreflang="en-us" href="/programming/vba/basic-vba/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0d0f1c3f4fe2190e7e8ae39cb8f4a753_123445_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0d0f1c3f4fe2190e7e8ae39cb8f4a753_123445_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/programming/vba/basic-vba/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Chiu Yu Ko">
  <meta property="og:url" content="/programming/vba/basic-vba/">
  <meta property="og:title" content="Basic VBA | Chiu Yu Ko">
  <meta property="og:description" content="Learning Objectives:
 What is VBA? Why VBA? Hello World What is function? What is subroutine? How to define variable? VBA Objects Record Macro  What is VBA? Why VBA? VBA stands for Visual Basic Application."><meta property="og:image" content="/images/icon_hu0d0f1c3f4fe2190e7e8ae39cb8f4a753_123445_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0d0f1c3f4fe2190e7e8ae39cb8f4a753_123445_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-04T00:00:00&#43;08:00">
    
    <meta property="article:modified_time" content="2019-05-04T00:00:00&#43;08:00">
  

  



  


  


  





  <title>Basic VBA | Chiu Yu Ko</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  









<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Chiu Yu Ko</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Chiu Yu Ko</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#book"><span>Book</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/programming/"><span>Programming</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/others/"><span>Others</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/programming/vba/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/programming/vba/basic-vba/">VBA Tutorial</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="/programming/vba/basic-vba/">Basic VBA</a>
      </li>
      
      <li >
        <a href="/programming/vba/advanced-vba/">Advanced VBA</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/programming/vba/excel-vba-r/">Book</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/programming/vba/excel-vba-r/">VBA and R</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-vba-why-vba">What is VBA? Why VBA?</a></li>
  </ul>

  <ul>
    <li><a href="#visual-basic-editor">Visual Basic Editor</a></li>
    <li><a href="#hello-world">Hello World</a></li>
    <li><a href="#variable">Variable</a></li>
    <li><a href="#subroutine-and-function">Subroutine and Function</a></li>
  </ul>

  <ul>
    <li><a href="#cells">Cells</a></li>
    <li><a href="#range">Range</a></li>
    <li><a href="#worksheets">Worksheets</a></li>
    <li><a href="#workbook">Workbook</a></li>
    <li><a href="#application">Application</a></li>
    <li><a href="#active-objects">Active Objects</a></li>
    <li><a href="#with">With</a></li>
  </ul>

  <ul>
    <li><a href="#chart-sheet">Chart Sheet</a></li>
    <li><a href="#embedded-chart">Embedded Chart</a></li>
    <li><a href="#chart-type">Chart Type</a></li>
    <li><a href="#data-series">Data Series</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Basic VBA</h1>

          <div class="article-style">
            <p>Learning Objectives:</p>
<ul>
<li>What is VBA? Why VBA?</li>
<li>Hello World</li>
<li>What is function? What is subroutine?</li>
<li>How to define variable?</li>
<li>VBA Objects</li>
<li>Record Macro</li>
</ul>
<h2 id="what-is-vba-why-vba">What is VBA? Why VBA?</h2>
<p>VBA stands for Visual Basic Application. It shares the same syntax as Basic language. Every operation you can perform in Excel using keyboard and mouse can be represented by VBA code. Hence, it allows a lot of flexibility and functionality when using Excel.</p>
<p>VBA improves your logical thinking skills, and prepares you for other programming languages, since it is quite basic and the thinking processes can be applied to other languages (such as R in the next chapter). It is ideal for repetitive tasks (e.g. code a function that will run the same process each time, instead of typing it out manually)</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/oqr-LHptK4M" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h1 id="vba-basics">VBA Basics</h1>
<h2 id="visual-basic-editor">Visual Basic Editor</h2>
<p>First, we need to open Visual Basic Editor (VBE). There are two ways to open VBE: (1) Press <strong>ALT+F11</strong> to open the Visual Basic Editor and (2)  File &gt; Options &gt; Customize Ribbon &gt; Developer(check the box) Developer Tab &gt; Visual Basic</p>





  











<figure >


  <a data-fancybox="" href="/img/Excel/VBA_Interface1.png" >


  <img src="/img/Excel/VBA_Interface1.png" alt=""  >
</a>



</figure>

<p>In the toolbar, select Insert \textgreater Module. Make sure you insert the module into the workbook that you are working on.</p>





  











<figure >


  <a data-fancybox="" href="/img/Excel/VBA_InsertModule.png" >


  <img src="/img/Excel/VBA_InsertModule.png" alt=""  >
</a>



</figure>

<p>Module is the place where you store the code. You can have as many modules as you want. You can put your code into different modules according to the functions they perform.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/1yuREZgjbTs" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="hello-world">Hello World</h2>
<p>We will use MsgBox function in VBA to create a popup window in Excel to say hello world.</p>
<pre><code>Sub HelloWorld()
     MsgBox (&quot;Hello World! I like VBA!&quot;)
End Sub
</code></pre>





  











<figure >


  <a data-fancybox="" href="/img/Excel/VBA_HelloWorld.png" >


  <img src="/img/Excel/VBA_HelloWorld.png" alt=""  >
</a>



</figure>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/-U_PWB2SljQ" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="variable">Variable</h2>
<p><code>Dim</code> is used to define variables. The syntax looks like this:</p>
<pre><code>Dim a As Integer
Dim b As Double
</code></pre>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>Integer</td>
<td>From –32,768 to 32,767</td>
</tr>
<tr>
<td>Long</td>
<td>From –2,147,483,648 to 2,147,486,647</td>
</tr>
<tr>
<td>Single</td>
<td>From –3402823E38 to –1.401298E–45 or 1.401298E–45 to 3.402823E38</td>
</tr>
<tr>
<td>Double</td>
<td>From –1.79769313486232E308 to –4.94065645841247E–324  or 1.79769313486232E308 to 4.94065645841247E–324</td>
</tr>
<tr>
<td>Boolean</td>
<td>Either 1 or 0</td>
</tr>
<tr>
<td>String</td>
<td>1 to 65,400 characters</td>
</tr>
<tr>
<td>Array</td>
<td>An array is a group of variables</td>
</tr>
<tr>
<td>Variant</td>
<td>Anything</td>
</tr>
</tbody>
</table>
<p>The following example display the value of variable.</p>
<pre><code>Sub DisplayVar()
Dim a as Integer
    a = 10
    Msgbox(&quot;My variable has the value of &quot; &amp; a &amp;&quot;.&quot;)
End Sub
</code></pre>
<p>One useful function of MsgBox is to check if certain sections of your code are running properly.</p>
<h2 id="subroutine-and-function">Subroutine and Function</h2>
<p>In terms of the code that you can program inside, a <code>Function</code> and a <code>Sub</code> are similar. The main difference is that a Sub performs a task, but returns no output, while a Function takes in input and returns output.</p>
<p>Our Hello World is an example of Sub. The structure of sub is that it starts with <code>Sub</code> together with the name of the Sub, and it ends with <code>End Sub</code>. The code to run is in between.</p>
<pre><code>Sub Name()
        ---Task 1---
        ---Task 2---
End Sub
</code></pre>
<p>Inside a subroutine, we can call other subroutine. The following subroutine calls HelloWorld subroutine twice.</p>
<pre><code>Sub CallAnotherSub()
	Call HelloWorld
	Call HelloWorld
End Sub
</code></pre>
<p>The syntax for a function is similar. The structure of function is that it starts with <code>Function</code> together with the name of the Sub, and it ends with <code>End Function</code>. The code to run is in between.</p>
<p>However, two key differences: (1) we have to enter the variable to be processed and its variable type, and (2) we have to tell what is the output of the function.</p>
<pre><code>Function Name( Variable As Variable Type)
    ---Content here---
    Name = .....
End Function
</code></pre>
<p>Let us create a simple function that calculate length hypotenuse of a right-angle triangle. To calculate the length hypotenuse, we need to have lengths of the sides. Hence, since sides are number, we use double. Since the formula is square root of sum of squared length of the sides, we will use <code>^</code> as power and <code>Sqr</code> as square root function.</p>
<pre><code>Function Hypotenuse(a As Double, b As Double)
    Hypotenuse = Sqr(a ^ 2 + b ^ 2)
End Function
</code></pre>
<p>Go to spreadsheet then type <code>=Hypotenus(3,4)</code> into formula of any cell. You should get 5.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/g4Bq8QnThxM" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>We can also call function inside a subroutine. The following subroutine calls the hypotenus function.</p>
<pre><code>Sub MsgFunction()
	Msgbox(&quot;Secret is &quot; &amp; ABC(3,4))
End Sub
</code></pre>
<p>Recall the spreadsheet example of calculation of EMA. S</p>
<table>
<thead>
<tr>
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>n</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>beta</td>
<td><code>=2/(A1+1)</code></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>Date</td>
<td>Price</td>
<td>EMA(n)</td>
</tr>
<tr>
<td>4</td>
<td>02-May-16</td>
<td>10</td>
<td></td>
</tr>
<tr>
<td>&hellip;</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>06-May-16</td>
<td>8</td>
<td><code>=AVERAGE(B4:B8)</code></td>
</tr>
<tr>
<td>9</td>
<td>07-May-16</td>
<td></td>
<td><code>=$B$2*B9+(1-$B$2)*C8</code></td>
</tr>
</tbody>
</table>
<pre><code>Function EMA(EMAYes As Double, price As Double, n As Integer)
    beta = 2 / (n + 1)
    EMA = beta * price + (1 - beta) * EMAYes
End Function
</code></pre>
<p>We can simplify our spreadsheet using the VBA code as shown below.</p>
<table>
<thead>
<tr>
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>n</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>beta</td>
<td><code>=2/(A1+1)</code></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>Date</td>
<td>Price</td>
<td>EMA(n)</td>
</tr>
<tr>
<td>4</td>
<td>02-May-16</td>
<td>10</td>
<td></td>
</tr>
<tr>
<td>&hellip;</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>06-May-16</td>
<td>8</td>
<td><code>=AVERAGE(B4:B8)</code></td>
</tr>
<tr>
<td>9</td>
<td>07-May-16</td>
<td></td>
<td><code>=EMA(C7,B8,$B$1)</code></td>
</tr>
</tbody>
</table>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/ODH_pvw9GXI" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h1 id="objects">Objects</h1>
<p>Objects are special type of variables. In particular, they represent elements of Excel. Common used objects include</p>
<ol>
<li>cell,</li>
<li>range,</li>
<li>workbook,</li>
<li>worksheet,</li>
<li>active objects,</li>
<li>application and</li>
<li>chart.</li>
</ol>
<p>To use object, we can use either method or property.
<strong>Method</strong> is an action: activate, select, delete, value, formula, text, clear, copy, paste.</p>
<p><strong>Property</strong> is description: name, visible
Using a metaphor: If object is noun, method is verb and property is adjective</p>
<p><strong>Collections</strong> is an object that contain a group of the same object. For example, <code>Worksheets</code> contains all worksheet objects, and <code>Workbooks</code> contains all workbook objects. To call a particular worksheet, we would call the name of the particular sheet in Worksheets.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/uJj2SvK2PlA" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="cells">Cells</h2>
<p>Cells refers to one cell in a range but it is using coordinate instead of R1C1 as cell reference. The syntax is <code>Cells(row, column)</code>.</p>
<p>For example, the following sets the second row in the range C2:C5 to value of 3. In the other words, C3 is set to 3.</p>
<pre><code>Sub RangeAndCell()
Range(&quot;C2:C5&quot;).Cells(2, 1).Value = 3
End Sub
</code></pre>
<p>If the worksheet name is not explicitly stated, it is assumed that the code works on the active sheet.</p>
<pre><code>Sub WorkingOnCell()
Cells(1,1).value = 5
End Sub
</code></pre>
<p>Offset refers to another cell, taking reference from the current active cell.</p>
<pre><code>Sub CellOffSet()
Cells(1,1) = 5
Cells(1,1).Offset(0,1).Formula = &quot;=A1+1&quot;
Cells(1,1).Offset(1,0).Formula = &quot;=A1+2&quot;
End Sub
</code></pre>
<p>Then cell A1 is 5, cell B1 is 6 and cell A2 is 7</p>
<h2 id="range">Range</h2>
<p>Range is a collection of cells.</p>
<pre><code>Sub SheetAndRange()
Worksheets(&quot;sheet1&quot;).Range(&quot;A1&quot;).Value = 3
End Sub
</code></pre>
<p>This causes the worksheet named sheet1 to have the value 3 in cell A1. If the worksheet name is not explicitly stated, it is assumed that the code works on the active sheet.</p>
<p>The following code shows the formula, value, text property of range.</p>
<pre><code>Sub WorkingOnRange()
Range(&quot;A1&quot;).Formula = &quot;=RAND()&quot;
Range(&quot;B1:E3&quot;).Value = 6
Range(&quot;A1&quot;).Text=&quot;3+4&quot;
End Sub
</code></pre>
<p>The following code shows how to do copy, paste and paste special (value).</p>
<pre><code>Sub CopyAndPaste()
Range(&quot;A1:B5&quot;).Formula = &quot;=RAND()&quot;
Range(&quot;C1&quot;).Formula = &quot;=A1+B1&quot;
Range(&quot;C1&quot;).Copy 
Range(&quot;C2:C5&quot;).PasteSpecial
End Sub
</code></pre>
<p>The following code shows how to obtain input from the spreadsheet.</p>
<pre><code>Sub GetFromSheet ()
Dim a as Integer
Range(&quot;A1&quot;).Formula =&quot;=RANDBETWEEN(1,6)&quot;
a = Range(&quot;A1&quot;).Value
Msgbox(a)
End Sub
</code></pre>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/cvzV-VMOOUE" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="worksheets">Worksheets</h2>
<p>Worksheets are what we use in Excel, we can create multiple sheets and give them unique names etc. We can also add new sheets or delete sheets in our VBA code.</p>
<pre><code>Sub AddSheet()
   WorkSheets.Add
   WorkSheets(ActiveSheet.Name).Name = &quot;MySheet&quot;
End Sub

Sub DelSheet()
   Application.DisplayAlerts = False
   WorkSheets(&quot;MySheet&quot;).Delete
   Application.DisplayAlerts = True
End Sub
</code></pre>
<p>We can also activate, rename or hide/unhide worksheets:</p>
<pre><code>Worksheets(&quot;sheet1&quot;).Activate
Worksheets(&quot;sheet1&quot;).Delete
Worksheets(&quot;sheet2&quot;).Select
Worksheets(&quot;sheet1&quot;).Name=&quot;Me&quot;
Worksheets(&quot;sheet3&quot;).Visible=False
Worksheets.Add
</code></pre>
<h2 id="workbook">Workbook</h2>
<p>Workbook object is essentially one excel file.</p>
<pre><code>Sub WorkBookActiveName()
Workbooks(&quot;book1&quot;).Activate
MsgBox (Workbooks(&quot;book1&quot;).ActiveSheet.Name)
End Sub
</code></pre>
<h2 id="application">Application</h2>
<p>The following four lines show how to select using application objects. The first line chooses cell A1 in the active 2. The second line chooses the second column (of the active worksheet). The third line chooses the first row (of the active worksheet). The forth line chooses the worksheet with name <code>sheet1</code>.</p>
<pre><code>Application.ActiveSheet.Cells(1,1).Select
Application.Columns(2).Select
Application.Rows(1).Select
Application.Sheets(&quot;sheet1&quot;).Select
</code></pre>
<p>The following shows some actions in spreadsheet. The first line asks the program to redo all calculation for the spreadsheet. The second line perform <code>redo</code>.</p>
<pre><code>Application.Calculate
Application.Undo
</code></pre>
<p>Worksheet functions are application objects. They can be used directly. For example, the following three lines of code corresponds to calling <code>COUNT</code>, <code>SUM</code> and <code>AVERAGE</code> functions from the spreadsheet.</p>
<pre><code>Application.WorksheetFunction.Count
Application.WorksheetFunction.Sum
Application.WorksheetFunction.Average
</code></pre>
<p>Note that <code>Application.</code> can be omitted. The following function SumAvg that calculates sum of two averages of two input ranges.</p>
<pre><code>Function SumAvg(X as Range, Y as Range)
Dim xavg As Double
Dim yavg As Double
xavg = WorksheetFunction.Average(X)
yavg = WorksheetFunction.Average(Y)
SumAvg = xavg + yavg
End Function
</code></pre>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/dz_zVafkoEQ" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="active-objects">Active Objects</h2>
<p>ActiveCell refers to the currently selected cell in your Excel workbook. From there, you can add or delete data from the cell. For example,</p>
<pre><code>Sub WorkingActiveCell()
   ActiveCell.Delete
   ActiveCell.Value = 11
   ActiveCell.text = &quot;Helloworld&quot;
End Sub
</code></pre>
<p>The final value in the ActiveCell will be Helloworld. This is because you first deleted whatever was in the cell, then put the value 11 into the cell. After which, you overrode the previous value and put in the word Helloworld into the active cell.</p>
<p>The following shows how to display property of active objects. The first line display a message box that tells the address of the active cell, the second one tells the name of active worksheet, and the second line tells the name of the active workbook (the current file name).</p>
<pre><code>MsgBox (ActiveCell.Address)
MsgBox (ActiveSheet.Name)
MsgBox (ActiveWorkbook.Name)
</code></pre>
<h2 id="with">With</h2>
<p>Using a With statement allows you to code more efficiently, especially if you have to keep referring to the same object. The following example shows different properties are set for the cells(1,1).</p>
<pre><code>Sub WithExample()
With Cells(1, 1)
    .Value = 4
    .Interior.Color = RGB(255, 255, 0)
    .Font.Color = RGB(0, 255, 0)
End With
End Sub
</code></pre>
<p>The code within the With and End With part is applied to the specified cell, which in this case is Cells(1,1).</p>
<h1 id="charting">Charting</h1>
<p>For charting in Excel, there are two methods:</p>
<ol>
<li>chart sheet and</li>
<li>embedded chart.</li>
</ol>
<h2 id="chart-sheet">Chart Sheet</h2>
<p>Chart sheet is a worksheet that only has chart. It is an object in a workbook.</p>
<p>To create a new chart sheet, we use the command <code>Charts.Add</code>. Note that this is similar to adding new worksheet command <code>Worksheets.Add</code>.</p>
<p>Then we need to define data source using <code>.SetSourceData Source:=</code>.</p>
<p>Finally, we need to tell what kind of chart is plotting <code>.ChartType =</code>. For example, line chart is <code>xlLine</code></p>
<pre><code>Sub NewLineChartSheet()
Dim ChartSheet As Chart
Dim Data As Range
Set ChartSheet = Charts.Add
Set Data = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B3&quot;)
With ChartSheet
    .SetSourceData Source:=Data
    .ChartType = xlLine
End With
End Sub
</code></pre>
<p>It is useful to define a chart with name so that we can refer later.</p>
<pre><code>Sub NewNamedChartSheet()
Dim ChartSheet As Chart
Dim Data As Range
Set ChartSheet = Charts.Add
Set Data = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B30&quot;)
With ChartSheet
    .SetSourceData Source:=Data
    .ChartType = xlLine
    .Name = &quot;mychart&quot;
End With
End Sub
</code></pre>
<p>The following code changes a property of an existing chartsheet. The following code changes the chart by including additional data.</p>
<pre><code>Sub ChangeChartSheet()
Dim ChartSheet As Chart
Dim Data As Range
Set ChartSheet = Charts(&quot;mychart&quot;)
Set Data = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B50&quot;)
With ChartSheet
    .SetSourceData Source:=Data
End With
End Sub
</code></pre>
<h2 id="embedded-chart">Embedded Chart</h2>
<p>For the chart to be included in a worksheet, we use <code>ChartObjects.Add</code> instead.</p>
<p>We need to tell which worksheet to place the diagram and the distance from the top and left of spreadsheet as well as width and height</p>
<pre><code>Sub EmbeddedChart()
Dim mychart As Object
Dim Data As Range
Set mychart = Sheets(&quot;Sheet1&quot;).ChartObjects.Add(Left:=300, Width:=300, Top:=10, Height:=300)
Set Data = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B3&quot;)
With mychart.Chart
    .ChartType = xlLine
    .SetSourceData Source:=Data
End With
End Sub
</code></pre>
<p>We can give name to the object but not the chart.</p>
<pre><code>Sub EmbeddedNameChart()
Dim mychart As Object
Dim Data As Range
Set mychart = Sheets(&quot;Sheet1&quot;).ChartObjects.Add(Left:=300, Width:=300, Top:=10, Height:=300)
Sheets(&quot;Sheet1&quot;).ChartObjects(1).Name = &quot;mychart&quot;
Set Data = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B3&quot;)
With mychart.Chart
    .ChartType = xlLine
    .SetSourceData Source:=Data
End With
End Sub
</code></pre>
<p>The following code changes a property of an existing embedded chart. The following code changes the chart by including additional data.</p>
<pre><code>Sub ChangeEmbeddedChart()
Dim ChartObj As Object
Set ChartObj = Sheets(&quot;Sheet1&quot;).ChartObjects(&quot;Hello&quot;)
With ChartObj.Chart
    .SetSourceData Source:=Sheets(&quot;Sheet1&quot;).Range(&quot;A1:D3&quot;)
End With
End Sub
</code></pre>
<h2 id="chart-type">Chart Type</h2>
<p>Besides line chart, there are many different types of chart. Here are the common types.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Chart Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>xlLine</td>
<td>line chart</td>
</tr>
<tr>
<td>xlColumnClustered</td>
<td>Clustered Column (vertical bar chart)</td>
</tr>
<tr>
<td>xlBarClustered</td>
<td>Clustered bar (horizontal bar chart)</td>
</tr>
<tr>
<td>xlPie</td>
<td>Pie</td>
</tr>
<tr>
<td>xlArea</td>
<td>Area chart (line chart but colored area)</td>
</tr>
<tr>
<td>xlXYScatter</td>
<td>Scatter</td>
</tr>
<tr>
<td>xlRadar</td>
<td>Radar</td>
</tr>
<tr>
<td>xlStockHLC</td>
<td>High-Low-Close</td>
</tr>
<tr>
<td>xlStockOHLC</td>
<td>Open-High-Low-Close (Candle Stick)</td>
</tr>
<tr>
<td>xlStockVHLC</td>
<td>Volume-High-Low-Close</td>
</tr>
<tr>
<td>xlStockVOHLC</td>
<td>Volume-Open-High-Low-Close</td>
</tr>
</tbody>
</table>
<h2 id="data-series">Data Series</h2>
<p>To allow for multiple graphics to be plotted, we need to use <code>seriescollection</code>.</p>
<p>First, to add a new data, we need to say <code>.SeriesCollection.NewSeries</code>. Then, we can define the name, XValues (x) and Values (y).</p>
<pre><code>Sub NewChartSheetMultiple()
Dim ChartSheet As Chart
Dim Time, Data1, Data2 As Range
Set ChartSheet = Charts.Add
Set Time = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:A5&quot;)
Set Data1 = Sheets(&quot;Sheet1&quot;).Range(&quot;B1:B5&quot;)
Set Data2 = Sheets(&quot;Sheet1&quot;).Range(&quot;C1:C5&quot;)
With ChartSheet
    .ChartType = xlLine
    
    .SeriesCollection.NewSeries
    .SeriesCollection(1).Name = &quot;Stock 1&quot;
    .SeriesCollection(1).XValues = Time
    .SeriesCollection(1).Values = Data1
    
    .SeriesCollection.NewSeries
    .SeriesCollection(2).Name = &quot;Stock 2&quot;
    .SeriesCollection(2).XValues = Time
    .SeriesCollection(2).Values = Data2
End With
End Sub
</code></pre>
<h1 id="record-macro">Record Macro</h1>
<p>Lastly, to see how to code certain actions in Excel, VBA has this useful function called Record Macro. 
To access it, in the Developer Tab, press the Record Macro button.</p>





  











<figure >


  <a data-fancybox="" href="/img/Excel/VBA_RecordMacro.png" >


  <img src="/img/Excel/VBA_RecordMacro.png" alt=""  >
</a>



</figure>

<p>Whatever you do in Excel from then on will be recorded in a macro, which you can later access. To stop recording, click the button again, which should now say Stop Recording. 
Click on the Visual Basic button (access to VBE) to see your recorded actions in code. This is useful if you know what you want to code, and how to do it in Excel, but you do not know how to code it in VBA.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/yZsul8ZGr6k" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h1 id="macro-enable-file">Macro-enable File</h1>
<p>Note that when you save your Excel file, always save it in <strong>xlsm</strong> format (macro enabled worksheet format), otherwise you will not be able to run your macros when you open the file next time!</p>





  











<figure >


  <a data-fancybox="" href="/img/Excel/VBA_savexlam.png" >


  <img src="/img/Excel/VBA_savexlam.png" alt=""  >
</a>



</figure>


          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/programming/vba/advanced-vba/" rel="next">Advanced VBA</a>
  </div>
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 4, 2019</p>

          






  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/programming%5cvba%5cBasic-VBA.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          


          


  
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    Copyright © 2012-2023. All Rights Reserved.
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
